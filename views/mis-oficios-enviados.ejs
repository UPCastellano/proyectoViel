<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="/css/styles.css">
    <title>Mis Oficios Enviados</title>
</head>
<body>
    <div class="d-flex">
        <nav class="sidebar" id="sidebar">
            <div class="logo-container text-center">
                <img src="/images/logo.png" alt="Logo" class="logo">
            </div>
            <ul class="list-unstyled">
                <li>
                    <a href="/dashboard" class="nav-link item"><i class="fas fa-home"></i> INICIO</a>
                </li>
                <li>
                    <a href="#oficios" class="nav-link" data-toggle="collapse">
                        <i class="fas fa-briefcase"></i> OFICIOS CREADOS
                    </a>
                    <ul class="collapse" id="oficios">
                        <li><a href="/oficios/crear-nuevo" class="nav-link item"><i class="fas fa-plus"></i> Crear nuevo</a></li>
                        <li><a href="/oficios/mis-oficios-enviados" class="nav-link item"><i class="fas fa-paper-plane"></i> Mis oficios enviados</a></li>
                        <li><a href="/lista-general" class="nav-link item"><i class="fas fa-list"></i> Lista general</a></li>
                        <li><a href="/recepcion" class="nav-link item"><i class="fas fa-inbox"></i> En recepción</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#oficiosRecibidos" class="nav-link" data-toggle="collapse">
                        <i class="fas fa-inbox"></i> OFICIOS RECIBIDOS
                    </a>
                    <ul class="collapse" id="oficiosRecibidos">
                        <li><a href="/agregar-oficio" class="nav-link item"><i class="fas fa-plus"></i> Agregar</a></li>
                        <li><a href="/ver-todos" class="nav-link item"><i class="fas fa-eye"></i> Ver todos</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#actas" class="nav-link" data-toggle="collapse">
                        <i class="fas fa-file-alt"></i> ACTAS
                    </a>
                    <ul class="collapse" id="actas">
                        <li><a href="/crear-acta" class="nav-link item"><i class="fas fa-plus"></i> Crear una nueva</a></li>
                        <li><a href="/mis-actas-creadas" class="nav-link item"><i class="fas fa-file"></i> Mis actas creadas</a></li>
                        <li><a href="/reuniones-realizadas" class="nav-link item"><i class="fas fa-calendar-check"></i> Reuniones realizadas</a></li>
                        <li><a href="/agregar-participante" class="nav-link item"><i class="fas fa-user-plus"></i> Agregar Participante</a></li>
                    </ul>
                </li>
                <li>
                    <a href="/logout" class="nav-link"><i class="fas fa-sign-out-alt"></i> SALIR</a>
                </li>
            </ul>
        </nav>
        <div class="dashboard-main-content">
            <div class="d-flex align-items-center mb-4" style="padding-top: 40px;">
                <a href="/dashboard" class="btn btn-outline-primary mr-3" title="Ir al Dashboard">
                    <i class="fas fa-home"></i>
                </a>
                <h2 class="text-center mb-4 flex-grow-1">Mis Oficios Enviados</h2>
            </div>
            <div class="dashboard-content-area" style="background: #fff; border-radius: 12px; box-shadow: 0 4px 24px rgba(0,0,0,0.08); padding: 32px 24px;">
                <div class="table-responsive">
                    <table id="oficiosTable" class="table table-striped table-bordered">
                        <thead class="thead-dark">
                            <tr>
                                <th># Oficio</th>
                                <th>Asunto</th>
                                <th>Fecha</th>
                                <th>Responsable</th>
                                <th>Destinatario</th>
                                <th>Observaciones</th>
                                <th>Estado</th>
                                <th>Área</th>
                                <th>Acción</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if(oficios && oficios.length > 0) { %>
                                <% oficios.forEach(function(oficio, idx) { %>
                                    <tr>
                                        <td><%= oficio.id %></td>
                                        <td><%= oficio.asunto %></td>
                                        <td><%= oficio.fecha ? oficio.fecha.toISOString().split('T')[0] : '' %></td>
                                        <td><%= oficio.responsable %></td>
                                        <td><%= oficio.destinatario %></td>
                                        <td><%= oficio.observaciones %></td>
                                        <td>
                                            <% if(oficio.estado === 'Pendiente') { %>
                                                <span class="badge badge-warning">Pendiente</span>
                                            <% } else if(oficio.estado === 'Enviado') { %>
                                                <span class="badge badge-info">Enviado</span>
                                            <% } else if(oficio.estado === 'Recibido') { %>
                                                <span class="badge badge-success">Recibido</span>
                                            <% } else { %>
                                                <span class="badge badge-secondary"><%= oficio.estado %></span>
                                            <% } %>
                                        </td>
                                        <td><%= oficio.area %></td>
                                        <td class="text-center">
                                            <div class="d-flex justify-content-center align-items-center gap-2">
                                                <a href="/oficios/actualizar/<%= oficio.id %>" class="btn btn-sm btn-primary d-flex align-items-center justify-content-center mx-1" style="width:32px; height:32px;" title="Actualizar">
                                                    <i class="fas fa-pen-to-square"></i>
                                                </a>
                                                <a href="/oficios/redactar/<%= oficio.id %>" class="btn btn-sm btn-dark d-flex align-items-center justify-content-center mx-1" style="width:32px; height:32px;" title="Redactar">
                                                    <i class="fas fa-feather-alt"></i>
                                                </a>
                                            </div>
                                        </td>
                                    </tr>
                                <% }); %>
                            <% } else { %>
                                <tr>
                                    <td colspan="8" class="text-center">No hay oficios enviados</td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="user-circle" id="userCircle">
            <i class="fas fa-user-circle user-icon"></i>
            <div class="logout-menu" id="logoutMenu">
                <a href="/logout">Logout</a>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/js/all.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#oficiosTable').DataTable({
                language: {
                    url: '//cdn.datatables.net/plug-ins/1.10.21/i18n/Spanish.json'
                },
                pageLength: 10,
                lengthMenu: [5, 10, 25, 50],
                order: [[ 0, 'desc' ]]
            });
        });
        // Script para mostrar/ocultar el menú al pasar el cursor
        const sidebar = document.getElementById('sidebar');
        sidebar.addEventListener('mouseenter', () => {
            sidebar.classList.add('active');
        });
        sidebar.addEventListener('mouseleave', () => {
            sidebar.classList.remove('active');
        });

        const userCircle = document.getElementById('userCircle');
        const logoutMenu = document.getElementById('logoutMenu');

        userCircle.addEventListener('click', () => {
            logoutMenu.style.display = logoutMenu.style.display === 'block' ? 'none' : 'block'; // Alternar visibilidad
        });

        // Cerrar el menú si se hace clic fuera de él
        window.addEventListener('click', (event) => {
            if (!userCircle.contains(event.target) && !logoutMenu.contains(event.target)) {
                logoutMenu.style.display = 'none';
            }
        });
    </script>
</body>
</html> 