<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/styles.css">
    <title>Crear Nuevo Oficio</title>
</head>
<body>
    <div class="d-flex">
        <nav class="sidebar" id="sidebar">
            <div class="logo-container text-center">
                <img src="/images/logo.png" alt="Logo" class="logo">
            </div>
            <ul class="list-unstyled">
                <li>
                    <a href="/dashboard" class="nav-link item"><i class="fas fa-home"></i> INICIO</a>
                </li>
                <li>
                    <a href="#oficios" class="nav-link" data-toggle="collapse">
                        <i class="fas fa-briefcase"></i> OFICIOS CREADOS
                    </a>
                    <ul class="collapse" id="oficios">
                        <li><a href="/oficios/crear-nuevo" class="nav-link item"><i class="fas fa-plus"></i> Crear nuevo</a></li>
                        <li><a href="/oficios/mis-oficios-enviados" class="nav-link item"><i class="fas fa-paper-plane"></i> Mis oficios enviados</a></li>
                        <li><a href="/lista-general" class="nav-link item"><i class="fas fa-list"></i> Lista general</a></li>
                        <li><a href="/recepcion" class="nav-link item"><i class="fas fa-inbox"></i> En recepción</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#oficiosRecibidos" class="nav-link" data-toggle="collapse">
                        <i class="fas fa-inbox"></i> OFICIOS RECIBIDOS
                    </a>
                    <ul class="collapse" id="oficiosRecibidos">
                        <li><a href="/agregar-oficio" class="nav-link item"><i class="fas fa-plus"></i> Agregar</a></li>
                        <li><a href="/ver-todos" class="nav-link item"><i class="fas fa-eye"></i> Ver todos</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#actas" class="nav-link" data-toggle="collapse">
                        <i class="fas fa-file-alt"></i> ACTAS
                    </a>
                    <ul class="collapse" id="actas">
                        <li><a href="/crear-acta" class="nav-link item"><i class="fas fa-plus"></i> Crear una nueva</a></li>
                        <li><a href="/mis-actas-creadas" class="nav-link item"><i class="fas fa-file"></i> Mis actas creadas</a></li>
                        <li><a href="/reuniones-realizadas" class="nav-link item"><i class="fas fa-calendar-check"></i> Reuniones realizadas</a></li>
                        <li><a href="/agregar-participante" class="nav-link item"><i class="fas fa-user-plus"></i> Agregar Participante</a></li>
                    </ul>
                </li>
                <li>
                    <a href="/logout" class="nav-link"><i class="fas fa-sign-out-alt"></i> SALIR</a>
                </li>
            </ul>
        </nav>
        <div class="w-100">
            <div class="d-flex align-items-center mb-4" style="padding-top: 20px;">
                <a href="/dashboard" class="btn btn-outline-primary mr-3" title="Ir al Dashboard">
                    <i class="fas fa-home"></i>
                </a>
                <div class="container d-flex flex-column align-items-center justify-content-center" style="min-height: 80vh;">
                    <div class="w-100" style="max-width: 500px;">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h2 class="text-center flex-grow-1" style="font-weight: 600;">
                                <%= editar ? 'Editar Oficio' : 'Crear Nuevo Oficio' %>
                            </h2>
                        </div>
                        <form action="<%= editar ? ('/oficios/actualizar/' + (oficio ? oficio.id : '')) : '/oficios/crear' %>" method="POST">
                            <div class="form-group">
                                <label for="asunto_oficio">Asunto</label>
                                <input type="text" class="form-control" id="asunto_oficio" name="asunto" required value="<%= oficio ? oficio.asunto : '' %>">
                            </div>
                            <div class="form-group">
                                <label for="fecha_oficio">Fecha</label>
                                <input type="date" class="form-control" id="fecha_oficio" name="fecha" required value="<%= oficio && oficio.fecha ? oficio.fecha.toISOString().split('T')[0] : '' %>">
                            </div>
                            <div class="form-group">
                                <label for="responsable_oficio">Responsable</label>
                                <input type="text" class="form-control" id="responsable_oficio" name="responsable" value="<%= oficio ? oficio.responsable : (user ? user.email : '') %>" readonly>
                            </div>
                            <div class="form-group">
                                <label for="destinatario_oficio">Destinatario</label>
                                <input type="text" class="form-control" id="destinatario_oficio" name="destinatario" required value="<%= oficio ? oficio.destinatario : '' %>">
                            </div>
                            <div class="form-group">
                                <label for="area_oficio">Área</label>
                                <select class="form-control" id="area_oficio" name="area" required>
                                    <option value="">Seleccione un área</option>
                                    <option value="Informatica" <%= oficio && oficio.area === 'Informatica' ? 'selected' : '' %>>Informática</option>
                                    <option value="equipamiento medico" <%= oficio && oficio.area === 'equipamiento medico' ? 'selected' : '' %>>Equipamiento Médico</option>
                                    <option value="Recursos Humanos" <%= oficio && oficio.area === 'Recursos Humanos' ? 'selected' : '' %>>Recursos Humanos</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="estado_oficio">Estado</label>
                                <select class="form-control" id="estado_oficio" name="estado" required>
                                    <option value="Pendiente" <%= oficio && oficio.estado === 'Pendiente' ? 'selected' : '' %>>Pendiente</option>
                                    <option value="Enviado" <%= oficio && oficio.estado === 'Enviado' ? 'selected' : '' %>>Enviado</option>
                                    <option value="Recibido" <%= oficio && oficio.estado === 'Recibido' ? 'selected' : '' %>>Recibido</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="observaciones_oficio">Observaciones</label>
                                <textarea class="form-control" id="observaciones_oficio" name="observaciones"><%= oficio ? oficio.observaciones : '' %></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary btn-block"><%= editar ? 'Actualizar Oficio' : 'Crear Oficio' %></button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="user-circle" id="userCircle" style="position: fixed; top: 20px; right: 30px; z-index: 2000;">
            <i class="fas fa-user-circle user-icon"></i>
            <div class="logout-menu" id="logoutMenu">
                <a href="/logout">Logout</a>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/js/all.min.js"></script>
    <script>
        // Script para mostrar/ocultar el menú al pasar el cursor
        const sidebar = document.getElementById('sidebar');
        sidebar.addEventListener('mouseenter', () => {
            sidebar.classList.add('active');
        });
        sidebar.addEventListener('mouseleave', () => {
            sidebar.classList.remove('active');
        });

        const userCircle = document.getElementById('userCircle');
        const logoutMenu = document.getElementById('logoutMenu');

        userCircle.addEventListener('click', () => {
            logoutMenu.style.display = logoutMenu.style.display === 'block' ? 'none' : 'block'; // Alternar visibilidad
        });

        // Cerrar el menú si se hace clic fuera de él
        window.addEventListener('click', (event) => {
            if (!userCircle.contains(event.target) && !logoutMenu.contains(event.target)) {
                logoutMenu.style.display = 'none';
            }
        });
    </script>
</body>
</html> 