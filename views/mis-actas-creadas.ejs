<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.2/css/buttons.dataTables.min.css">
    <link rel="stylesheet" href="/css/styles.css">
    <title>Mis Actas Creadas</title>
</head>
<body>
    <div class="d-flex">
        <nav class="sidebar" id="sidebar">
            <div class="logo-container text-center">
                <img src="/images/logo.png" alt="Logo" class="logo">
            </div>
            <ul class="list-unstyled">
                <li>
                    <a href="#actas" class="nav-link active" data-toggle="collapse">
                        <i class="fas fa-file-alt"></i> ACTAS
                    </a>
                    <ul class="collapse show" id="actas">
                        <li><a href="/crear-acta" class="nav-link item"><i class="fas fa-plus"></i> Crear una nueva</a></li>
                        <li><a href="/mis-actas-creadas" class="nav-link item active"><i class="fas fa-file"></i> Mis actas creadas</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#oficios" class="nav-link" data-toggle="collapse">
                        <i class="fas fa-briefcase"></i> OFICIOS CREADOS
                    </a>
                    <ul class="collapse" id="oficios">
                        <li><a href="/oficios/crear-nuevo" class="nav-link item"><i class="fas fa-plus"></i> Crear nuevo</a></li>
                        <li><a href="/oficios/mis-oficios-enviados" class="nav-link item"><i class="fas fa-paper-plane"></i> Mis oficios enviados</a></li>
                        <li><a href="/oficios/lista-general" class="nav-link item"><i class="fas fa-list"></i> Lista general</a></li>
                        <li><a href="/oficios/recepcion" class="nav-link item"><i class="fas fa-inbox"></i> En recepción</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#oficiosRecibidos" class="nav-link" data-toggle="collapse">
                        <i class="fas fa-inbox"></i> OFICIOS RECIBIDOS
                    </a>
                    <ul class="collapse" id="oficiosRecibidos">
                        <li><a href="/oficios/crear-recibido" class="nav-link item"><i class="fas fa-plus"></i> Agregar</a></li>
                        <li><a href="/oficios/recibidos" class="nav-link item"><i class="fas fa-eye"></i> Ver todos</a></li>
                    </ul>
                </li>
                <li>
                    <a href="/logout" class="nav-link"><i class="fas fa-sign-out-alt"></i> SALIR</a>
                </li>
            </ul>
        </nav>
        <div class="dashboard-main-content">
            <div class="d-flex align-items-center mb-4" style="padding-top: 40px;">
                <a href="/dashboard" class="btn btn-outline-primary mr-3" title="Ir al Dashboard">
                    <i class="fas fa-home"></i>
                </a>
                <h2 class="text-center mb-4 flex-grow-1">Mis Actas Creadas</h2>
            </div>
            <div class="dashboard-content-area" style="background: #fff; border-radius: 12px; box-shadow: 0 4px 24px rgba(0,0,0,0.08); padding: 32px 24px;">
                <div class="table-responsive">
                    <table id="actasTable" class="table table-striped table-bordered">
                        <thead class="thead-dark">
                            <tr>
                                <th>#</th>
                                <th>Tipo de reunión</th>
                                <th>Fecha</th>
                                <th>Hora</th>
                                <th>Temas abordados</th>
                                <th>Participantes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if(actas && actas.length > 0) { %>
                                <% actas.forEach(function(acta, idx) { %>
                                    <tr>
                                        <td><%= idx + 1 %></td>
                                        <td><%= acta.tipo_reunion %></td>
                                        <td>
                                            <% if (acta.fecha) { %>
                                                <%= (typeof acta.fecha === 'string' ? acta.fecha : acta.fecha.toISOString().split('T')[0]) %>
                                            <% } else { %>
                                                
                                            <% } %>
                                        </td>
                                        <td><%= acta.hora ? acta.hora.substring(0,5) : '' %></td>
                                        <td><%= acta.temas_abordados %></td>
                                        <td><%= acta.participantes %></td>
                                    </tr>
                                <% }); %>
                            <% } else { %>
                                <tr>
                                    <td colspan="6" class="text-center">No hay actas creadas</td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="user-circle" id="userCircle" style="position: fixed; top: 20px; right: 30px; z-index: 2000;">
            <i class="fas fa-user-circle user-icon"></i>
            <div class="logout-menu" id="logoutMenu">
                <a href="/logout">Logout</a>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.2/js/buttons.print.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/js/all.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#actasTable').DataTable({
                language: {
                    url: '//cdn.datatables.net/plug-ins/1.10.21/i18n/Spanish.json'
                },
                pageLength: 10,
                lengthMenu: [5, 10, 25, 50],
                order: [[ 2, 'desc' ]],
                dom: 'Bfrtip',
                buttons: [
                    {
                        extend: 'excelHtml5',
                        text: '<i class="fas fa-file-excel"></i> Excel',
                        className: 'btn btn-success btn-sm'
                    },
                    {
                        extend: 'pdfHtml5',
                        text: '<i class="fas fa-file-pdf"></i> PDF',
                        className: 'btn btn-danger btn-sm',
                        orientation: 'landscape',
                        pageSize: 'A4',
                        exportOptions: {
                            columns: ':visible'
                        }
                    }
                ]
            });
        });
        // Script para mostrar/ocultar el menú al pasar el cursor
        const sidebar = document.getElementById('sidebar');
        sidebar.addEventListener('mouseenter', () => {
            sidebar.classList.add('active');
        });
        sidebar.addEventListener('mouseleave', () => {
            sidebar.classList.remove('active');
        });

        const userCircle = document.getElementById('userCircle');
        const logoutMenu = document.getElementById('logoutMenu');

        userCircle.addEventListener('click', () => {
            logoutMenu.style.display = logoutMenu.style.display === 'block' ? 'none' : 'block';
        });

        window.addEventListener('click', (event) => {
            if (!userCircle.contains(event.target) && !logoutMenu.contains(event.target)) {
                logoutMenu.style.display = 'none';
            }
        });
    </script>
</body>
</html> 